# 유지보수와 리팩토링
## EP 2. 코드 단위를 짧게 하라

> 코드 단위는 15라인을 넘어가지 않게 작성한다.

독립적으로 관리 및 실행 할 수 있는 최소한의 코드 그룹을 단위(unit)이라고 한다.
자바에서는 메서드나 생성자에 해당한다. 단위는 재사용, 테스트가 가능한 가장 작은 코드 조각이다.

<br>
<br>

단위를 짧게 쓰면 테스트, 분석, 재사용 모두 쉬워지는 장점이 있다.

<br>

새 단위를 작성할 때 코드가 15라인 근처에 이르기 전에 기능을 하나 더 추가하는 방안을 생각해봐라.
메서드 명 때문에 주석이 필요하지 않을 수도 있다. 단위를 짧게 하면 소스 코드가 스스로를 설명하는 형태(self-explanatory)로 바뀐다.

<br>

유지보수 가능한 코드를 작성하는 일은 언제나 다른 가이드라인과의 타협(trade-off)의 문제이다. 한 단위를 여러 단위로 나누면 전체 코드 볼륨이 커지니 코드 베이스를 작게 유지하라는 가이드라인을 위반한 것처럼 보이지만, 분석/테스트할 대상 단위의 크기와 복잡도는 줄었으므로 결국 유지보수성은 나아진 셈이다.

<br>
<br>

로컬 변수에 접근하는 메소드를 추출하고 싶은 경우 메서드를 메서드 객체로 대체(Replace Method with Method Object) 리팩토링 기법을 사용해보자. 멤버 변수와 생성자, 세터를 이용한 쉽게 말해서 DTO를 사용하는 것이다.

<br>
<br>

단위를 짧게 작성하면 단위 개수가 늘어나고 메서드 호출이 잦아지니까 성능상 좋을 게 없다라는 말은 이론적으로 맞는 말이긴 하다. 하지만 최악의 경우를 생각해도 밀리 초 단위 정도의 성능 저하에 불과하기 때문제 문제가 되지 않는다. JVM이 내부적으로 아주 능숙하게 메서드 호출 오버헤드를 최적하기 때문이다.

<br>

코드를 여러 단위로 펼치면 읽기가 어렵다고 할 수 있는데, 심리학적으로 인간은 대략 7가지를 기억할 수 있어서 7라인보다 훨씬 긴 코드로 작성한 단위는 모든 코드를 제대로 분석하기 어렵다.

<br>

의외로 메서드를 나누기 까다로운 경우도 있다. 예를 들어 switch문 혹은 JPA의 메서드를 생각해보자. 뒤에서 더 다루기로 하겠다.

<br>
<br>

짧은 단위(15라인 이하)로 코드를 나눌 때는 기능을 잘 나타내는 이름을 붙이도록 하자.